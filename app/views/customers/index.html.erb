<header class="HeaderWrapper">
  <div class="LogoArea"></div>
  <div class="RightSideWrapper">
    <div class="PageNameArea"><%= link_to "Dashboard", dashboard_path %></div>
    <%= link_to "Promotions <i class='mediuem material-icons right'> loyalty</i>".html_safe, shop_owner_promotions_path(current_shop_owner) %>
  </div>
</header>
<div class="LowerWrapper">
  <!-- <aside class="AsideWrapper">

  </aside> -->
  <main class="MainWrapper container">
<p id="notice"><%= notice %></p>

<h1>Customers</h1>
<%= link_to "<i class=' medium material-icons right'> add supervisor_account</i>".html_safe,new_shop_owner_customer_path(current_shop_owner), :class => "btn-floating btn-large waves-effect waves-light blue shape"%>
<table class="bordered">

<table class="responsive-table centered highlight customer-table">
  <thead>
    <tr>
      <th>Name</th>
      <th>Language</th>
      <th>Ph number</th>
      <th>Email</th>
      <th>Shop owner</th>

      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% if @customers.empty? %>
    <p>There are no customers.</p>
    <% else %>
    <% @customers.each_with_index do |customer,ix| %>
      <tr class="striped">
        <td><%= customer.name %></td>
        <td><%= customer.language %></td>
        <td><%= customer.ph_number %></td>
        <td><%= customer.email %></td>
        <td><%= customer.shop_owner.name %></td>

        <td><%= link_to "<i class='small material-icons'> supervisor_account</i>".html_safe, "#modal_#{ix}" %></td>
        <td><%= link_to "<i class='small material-icons'> mode_edit</i>".html_safe, edit_shop_owner_customer_path(current_shop_owner,customer)%></td>
        <td><%= link_to "<i class='small material-icons'> delete</i>".html_safe, shop_owner_customer_path(current_shop_owner,customer), method: :delete, data: { confirm: 'Are you sure?' }%></td>

      </tr>
      <!-- Modal Structure -->
      <div id="<%= "modal_#{ix}" %>" class="modal">
        <div class="modal-content">
          <main class="MainWrapper">

            <p id="notice"><%= notice %></p>
            <div class="CustomerShow">
            <p>
              <strong>Name:</strong>
              <%= customer.name %>
            </p>

            <p>
              <strong>Language:</strong>
              <%= customer.language %>
            </p>

            <p>
              <strong>Ph number:</strong>
              <%= customer.ph_number %>
            </p>

            <p>
              <strong>Email:</strong>
              <%= customer.email %>
            </p>

            <p>
              <strong>Shop owner:</strong>
              <%= customer.shop_owner.name %>
            </p>

            <% if customer.sent_customer_promotions.count > 0 %>
              <h3>Messages Sent</h3>
              <ul>
                <% customer.sent_customer_promotions.each do |cp| %>
                  <li>Body: <%= customer.language == "Spanish" ? cp.promotion.translated_text : cp.promotion.body %>,
                      Sent: <%= time_ago_in_words cp.sent_time %></li>
                <% end %>
              </ul>
            <% end %>

            <%= link_to 'Edit', edit_shop_owner_customer_path(current_shop_owner, customer) %> |
          </main>
        </div>
        <div class="modal-footer">
          <a href="#!" class="modal-action modal-close waves-effect waves-green btn-flat">Close</a>
        </div>
      </div>

    <% end %>
    <% end %>
  </tbody>
</table>

<br>

<%= link_to 'New Customer', new_shop_owner_customer_path(current_shop_owner) %>
<%= link_to 'Promotions', shop_owner_promotions_path(current_shop_owner) %>
</main>

<!-- "customer-list"> -->
